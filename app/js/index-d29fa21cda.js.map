{"version":3,"sources":["index.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index-d29fa21cda.js","sourcesContent":["let empty_object = {\r\n    \"id\": \"\",\r\n    \"name\": \"\",\r\n    \"email\": \"\",\r\n    \"memory_limit\": \"\",\r\n    \"operation\": \"singup\"\r\n};\r\n\r\nlet logged_in_object = empty_object;\r\nlet selected_files = [];\r\nlet file_constraints = {};\r\n\r\n$(document).ready(function () {\r\n    isLoggedIn();\r\n\r\n    // getUserData();\r\n\r\n    $(document).on('hidden.bs.modal', \"#upload_modal\", function (e) {\r\n        selected_files = [];\r\n    });\r\n\r\n    $(document).on('show.bs.modal', \"#upload_modal\", function (e) {\r\n        dragAndDropFunctions();\r\n    });\r\n\r\n    $(document).on(\"click\", \".delete_selected_file\", function () {\r\n        removeSelectedFile($(this).closest(\"tr\").attr(\"data-selected_file_index\"))\r\n    });\r\n\r\n    $(document).on(\"change\", \"#user_file\", function () {\r\n        updateSelectedFileTable($(this).prop('files'));\r\n    });\r\n\r\n    $(document).on(\"click\", \"#confirm_file_delete\", function () {\r\n        deleteFile($(this).attr(\"data-file_name\"));\r\n    });\r\n\r\n    $(document).on(\"click\", \"#edit_profile\", function () {\r\n        getEditProfile();\r\n    });\r\n\r\n    $(document).on(\"click\", \".delete_file\", function () {\r\n        openConfirmDeleteModal($(this));\r\n    });\r\n\r\n    $(document).on(\"click\", \"#upload_file\", function () {\r\n        openUploadModal();\r\n    });\r\n\r\n    $(document).on(\"click\", \"#change_password_gui\", function () {\r\n        openChangePasswordModal();\r\n    });\r\n\r\n    $(document).on(\"click\", \".set_password\", function () {\r\n        openChangeUserPasswordModal($(this));\r\n    });\r\n\r\n    $(document).on(\"click\", \"#logout\", function () {\r\n        openConfirmLogout();\r\n    });\r\n\r\n    $(document).on(\"click\", \"#confirm_logout\", function () {\r\n        logout();\r\n    });\r\n\r\n    $(document).on(\"click\", \"#add_user\", function () {\r\n        openUserModal(\"add\", \"primary\", getEmptyObject(\"add\"));\r\n    });\r\n\r\n    $(document).on(\"click\", \".edit_user\", function () {\r\n        getUserData($(this).closest(\"tr\").attr(\"data-id\"));\r\n    });\r\n\r\n    $(document).on(\"submit\", \"#sign_up_form\", function () {\r\n        if (isLoginFormValid()) {\r\n            checkLogin();\r\n        }\r\n        return false;\r\n    });\r\n\r\n    $(document).on(\"submit\", \"#change_password_form\", function () {\r\n        if (isLoginFormValid()) {\r\n            changePassword($(this));\r\n        }\r\n        return false;\r\n    });\r\n\r\n    $(document).on(\"submit\", \"#file_upload_form\", function () {\r\n        if (isFilesValid()) {\r\n            uploadFiles(0);\r\n        }\r\n        return false;\r\n    });\r\n\r\n    $(document).on(\"submit\", \"#add_edit_form\", function () {\r\n        if (isLoginFormValid()) {\r\n            addEditUser($(this));\r\n        }\r\n        return false;\r\n    });\r\n\r\n    $(document).on(\"submit\", \"#login_form\", function () {\r\n        if (isLoginFormValid()) {\r\n            checkLogin();\r\n        }\r\n        return false;\r\n    });\r\n\r\n    $(document).on(\"click\", \"#sign_up_gui\", function () {\r\n        displaySignUpForm(getEmptyObject(\"signup\"));\r\n    });\r\n\r\n    $(document).on(\"click\", \"#sign_in_gui\", function () {\r\n        displayLoginForm(empty_object);\r\n    });\r\n});\r\n\r\nfunction isFilesValid() {\r\n    return true;\r\n}\r\n\r\nfunction getEmptyObject(operation) {\r\n    let ob = empty_object;\r\n    ob.operation = operation;\r\n    return ob;\r\n}\r\n\r\nfunction getUserForm(json_ob, id) {\r\n    console.log(json_ob, id);\r\n    let gui = \"\";\r\n\r\n    gui += \"<form class='form-horizontal' id='\" + id + \"'>\";\r\n\r\n    gui += getTextFiled(\"Name\", \"user_name\", \"Name\", \"text\", json_ob.name);\r\n    gui += getTextFiled(\"Email\", \"user_email\", \"Email\", \"email\", json_ob.email);\r\n\r\n    switch (json_ob.operation) {\r\n        case \"signup\":\r\n            gui += getTextFiled(\"Password\", \"user_password\", \"Password\", \"password\");\r\n            gui += getTextFiled(\"Repeat Password\", \"user_password_2\", \"Repeat Password\", \"password\");\r\n            break;\r\n        case \"add\":\r\n        case \"edit\":\r\n            if (edit_profile.hasOwnProperty(\"operation_type\") && Number(json_ob.usertype_id) === 1) {\r\n                gui += getTextFiled(\"Memory\", \"memory_limit\", \"Memory\", \"text\", json_ob.memory_limit);\r\n            }\r\n            break;\r\n    }\r\n\r\n    gui += \"<div class='form-group btn_group'>\";\r\n    gui += \"<div class='col-sm-offset-2 col-sm-10'>\";\r\n\r\n    if (json_ob.operation === \"signup\") {\r\n        gui += getButton(\"submit\", \"primary\", \"Sign Up\");\r\n        gui += getButton(\"reset\", \"default\", \"Clear\");\r\n        gui += getButton(\"button\", \"info pull-right\", \"Sign In\", \"sign_in_gui\");\r\n    }\r\n\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n    gui += \"</form>\";\r\n\r\n    return gui;\r\n}\r\n\r\nfunction displaySignUpForm() {\r\n    let gui = \"\";\r\n    gui += \"<div class='row'>\";\r\n    gui += \"<div class='col-md-6 col-md-offset-3 col-lg-4 col-lg-offset-3'>\";\r\n    gui += \"<fieldset>\";\r\n    gui += \"<legend>Sign-Up</legend>\";\r\n\r\n    gui += getUserForm(empty_object, \"sign_up_form\");\r\n\r\n    gui += \"</fieldset>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n\r\n    $(\"#main_container\").html(gui);\r\n}\r\n\r\nfunction isLoginFormValid() {\r\n    return true;\r\n}\r\n\r\nfunction checkLogin() {\r\n    $.ajax({\r\n        url: \"../classes/user.php\",\r\n        beforeSend: function () {\r\n        },\r\n        data: {\r\n            operation: \"check_login\",\r\n            email: $(\"#login_form #user_email\").val(),\r\n            password: $(\"#login_form #user_password\").val()\r\n        },\r\n        type: \"POST\",\r\n        success: function (response) {\r\n            var json_ob = JSON.parse(response);\r\n            if (json_ob !== false) {\r\n                if (json_ob.logged_in_user === false) {\r\n                    showAlert(setError(\"Invalid credentials\"));\r\n                } else {\r\n                    showAlert(setSuccess(\"Welcome \" + capitalizeEachWord(json_ob.logged_in_user.name)));\r\n                    logged_in_object = json_ob.logged_in_user;\r\n                    file_constraints = json_ob.file_constraints;\r\n\r\n                    if (json_ob.hasOwnProperty(\"users\")) {\r\n                        displayUserTable(json_ob.users);\r\n                    } else {\r\n                        displayUserFiles(json_ob);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        error: function (response) {\r\n        }\r\n    });\r\n}\r\n\r\nfunction addEditUser(ele) {\r\n    let operation = $(\"#user_operation\").attr(\"data-operation\");\r\n    let id = $(\"#user_operation\").attr(\"data-user_id\");\r\n\r\n    $.ajax({\r\n        url: \"../classes/user.php\",\r\n        beforeSend: function () {\r\n        },\r\n        data: {\r\n            operation: operation,\r\n            id: id,\r\n            name: $(\"#add_edit_form #user_name\").val(),\r\n            email: $(\"#add_edit_form #user_email\").val(),\r\n            memory_limit: $(\"#add_edit_form #memory_limit\").val()\r\n        },\r\n        type: \"POST\",\r\n        success: function (response) {\r\n            var json_ob = JSON.parse(response);\r\n            if (json_ob !== false) {\r\n                destroyModal($(\"#user_modal\"));\r\n                showAlert(json_ob.message);\r\n                logged_in_object = json_ob.logged_in_user;\r\n                $(\"#logged_username\").html(logged_in_object.name);\r\n                displayUserTable(json_ob.users);\r\n            }\r\n        },\r\n        error: function (response) {\r\n        }\r\n    });\r\n}\r\n\r\nfunction displayLoginForm(login_object) {\r\n    let gui = \"\";\r\n\r\n    gui += \"<div class='row'>\";\r\n    gui += \"<div class='col-md-6 col-md-offset-3 col-lg-4 col-lg-offset-3'>\";\r\n    gui += \"<fieldset>\";\r\n    gui += \"<legend>Login</legend>\";\r\n    gui += \"<form class='form-horizontal' id='login_form'>\";\r\n\r\n    gui += getTextFiled(\"Email\", \"user_email\", \"Email\", \"email\", login_object.email);\r\n    gui += getTextFiled(\"Password\", \"user_password\", \"Password\", \"password\");\r\n\r\n    gui += \"<div class='form-group btn_group'>\";\r\n    gui += \"<div class='col-sm-offset-3 col-sm-9 text-center'>\";\r\n\r\n    gui += getButton(\"submit\", \"primary\", \"Sign In\");\r\n    gui += getButton(\"reset\", \"default\", \"Clear\");\r\n    // gui += getButton(\"button\", \"info pull-right\", \"Sign Up\", \"sign_up_gui\");\r\n\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n    gui += \"</form>\";\r\n    gui += \"</fieldset>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n\r\n    $(\"#main_container\").html(gui);\r\n}\r\n\r\n\r\nfunction getUserData(id = \"\") {\r\n    $.ajax({\r\n        url: \"../classes/user.php\",\r\n        beforeSend: function () {\r\n        },\r\n        data: {\r\n            operation: \"get_user_data\",\r\n            id: id\r\n        },\r\n        type: \"POST\",\r\n        success: function (response) {\r\n            var json_ob = JSON.parse(response);\r\n            if (json_ob !== false) {\r\n                if (id === \"\") {\r\n                    displayUserTable(json_ob);\r\n                } else {\r\n                    json_ob[0].operation = \"edit\";\r\n                    openUserModal(\"edit\", \"warning\", json_ob[0]);\r\n                }\r\n            }\r\n        },\r\n        error: function (response) {\r\n        }\r\n    });\r\n}\r\n\r\nfunction getProfileMenu(jsob_ob) {\r\n    let gui = \"\";\r\n    gui += \"<div class='btn-group pull-right'>\";\r\n    gui += \"<button type='button' class='btn btn-default btn-xs dropdown-toggle' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>\";\r\n    gui += \"Welcome <span id='logged_username'>\" + capitalizeEachWord(jsob_ob.name) + \"</span> <span class='caret'></span>\";\r\n    gui += \"</button>\";\r\n    gui += \"<ul class='dropdown-menu'>\";\r\n    gui += \"<li><a href='#' id='edit_profile'>Edit Profile</a></li>\";\r\n    gui += \"<li><a href='#' id='change_password_gui'>Change Password</a></li>\";\r\n    gui += \"<li><a href='#' id='logout'>Logout</a></li>\";\r\n    gui += \"</ul>\";\r\n    gui += \"</div>\";\r\n    return gui;\r\n}\r\n\r\nfunction displayUserTable(json_ob) {\r\n    let gui = \"\";\r\n\r\n    gui += \"<div class='row'>\";\r\n    gui += \"<div class='col-md-7'>\";\r\n    gui += \"<div class='table-responsive'>\";\r\n    gui += \"<table class='table table-bordered'>\";\r\n    gui += \"<caption>\";\r\n    gui += getButton(\"button\", \"primary btn-xs\", \"Add User\", \"add_user\");\r\n    gui += getProfileMenu(logged_in_object);\r\n    gui += \"</caption>\";\r\n    gui += \"<thead>\";\r\n    gui += \"<tr>\";\r\n    gui += \"<th class='small_cell'>#</th>\";\r\n    gui += \"<th class='small_cell'>Operations</th>\";\r\n    gui += \"<th>Name</th>\";\r\n    gui += \"<th>Email</th>\";\r\n    gui += \"<th>Limit</th>\";\r\n    gui += \"</tr>\";\r\n    gui += \"</thead>\";\r\n    gui += \"<tbody>\";\r\n\r\n    $.each(json_ob, function (i, row) {\r\n        gui += \"<tr data-id='\" + row.id + \"'>\";\r\n        gui += \"<td class='small_cell text-center'>\" + (i + 1) + \"</td>\";\r\n        gui += \"<td class='btn_group'>\";\r\n        gui += getButton(\"button\", \"info btn-xs set_password\", \"Pass\");\r\n        gui += getButton(\"button\", \"warning btn-xs edit_user\", \"Edit\");\r\n        gui += getButton(\"button\", \"danger btn-xs delete_user\", \"Delete\");\r\n        gui += \"</td>\";\r\n        gui += \"<td>\" + row.name + \"</td>\";\r\n        gui += \"<td>\" + row.email + \"</td>\";\r\n        gui += \"<td class='small_cell text-center'>\" + row.memory_limit + \"</td>\";\r\n        gui += \"</tr>\";\r\n    });\r\n\r\n    gui += \"</tbody>\";\r\n    gui += \"</table>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n\r\n    $(\"#main_container\").html(gui);\r\n}\r\n\r\nfunction displayUserFiles(json_ob) {\r\n    let gui = \"\";\r\n\r\n    gui += \"<div class='row'>\";\r\n    gui += \"<div class='col-md-7'>\";\r\n    gui += \"<div class='table-responsive'>\";\r\n    gui += \"<table class='table table-bordered'>\";\r\n    gui += \"<caption>\";\r\n    gui += getButton(\"button\", \"primary btn-xs\", \"Upload\", \"upload_file\");\r\n    gui += getProfileMenu(logged_in_object);\r\n    gui += \"</caption>\";\r\n    gui += \"<thead>\";\r\n    gui += \"<tr>\";\r\n    gui += \"<th colspan='4' class='text-right'>Memory Usage : \" + json_ob.user_files.total_size + \" / \" + logged_in_object.memory_limit + \" MB</th>\";\r\n    gui += \"</tr>\";\r\n\r\n    gui += \"<tr>\";\r\n    gui += \"<th class='small_cell'>#</th>\";\r\n    gui += \"<th class='small_cell'>Operations</th>\";\r\n    gui += \"<th>File</th>\";\r\n    gui += \"<th>Size</th>\";\r\n    gui += \"</tr>\";\r\n    gui += \"</thead>\";\r\n    gui += \"<tbody>\";\r\n\r\n    $.each(json_ob.user_files.files, function (i, file) {\r\n        gui += \"<tr data-file_name='\" + file.name + \"'>\";\r\n        gui += \"<td class='small_cell text-center'>\" + (i + 1) + \"</td>\";\r\n        gui += \"<td class='btn_group text-center'>\";\r\n        gui += getButton(\"button\", \"danger btn-xs delete_file\", \"Delete\");\r\n        gui += \"</td>\";\r\n        gui += \"<td>\" + file.name + \"<a target='_blank' data-toggle='tooltip' title='Download' href='../classes/user.php?operation=download_file&f=\" + file.name + \"' class='pull-right'><i class='fa fa-download'></i></a></td>\";\r\n        gui += \"<td class='small_cell text-right'>\" + file.size + \"</td>\";\r\n        gui += \"</tr>\";\r\n    });\r\n\r\n    gui += \"</tbody>\";\r\n    gui += \"</table>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n\r\n    $(\"#main_container\").html(gui);\r\n    triggerTooltip();\r\n}\r\n\r\nfunction openUserModal(operation, color = \"primary\", json_ob = null) {\r\n    json_ob = json_ob !== null ? json_ob : empty_object;\r\n    operation = capitalizeEachWord(operation);\r\n    var modal_id = \"user_modal\";\r\n\r\n    var gui = \"\";\r\n    gui += \"<div id='\" + modal_id + \"' class='modal \" + color + \" fade' role='dialog'>\";\r\n    gui += \"<div class='modal-dialog'>\";\r\n    gui += \"<div class='modal-content'>\";\r\n    gui += \"<div class='modal-header'><h4 class='modal-title text-capitalize'>\" + operation + \" User</h4></div>\";\r\n    gui += \"<div class='modal-body'>\";\r\n\r\n    gui += getUserForm(json_ob, \"add_edit_form\");\r\n\r\n    let id = \"\";\r\n\r\n    if (json_ob !== null) {\r\n        if (json_ob.hasOwnProperty(\"id\")) {\r\n            id = \" data-user_id='\" + json_ob.id + \"'\";\r\n        }\r\n    }\r\n\r\n    gui += \"</div>\";\r\n    gui += \"<div class='modal-footer'>\";\r\n    gui += \"<button type='submit' form='add_edit_form' \" + id + \" data-operation='user_\" + operation.toLowerCase() + \"' id='user_operation' class='btn btn-\" + color + \"'>\" + operation + \"</button>\";\r\n    gui += \"<button type='reset' form='add_edit_form' class='btn btn-default'>Clear</button>\";\r\n    gui += \"<button type='button' class='btn btn-default' data-dismiss='modal'>Cancel</button>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n\r\n    if ($('#' + modal_id).length) {\r\n        $('#' + modal_id).replaceWith(gui);\r\n    } else {\r\n        $(\"body\").append(gui);\r\n    }\r\n\r\n    $('#' + modal_id).modal({backdrop: 'static', keyboard: false}, 'show');\r\n\r\n\r\n    if ($(\".modal.in\").length > 0) {\r\n        var zindex = JSON.parse($(\".modal.in:last\").css(\"z-index\"));\r\n        $('#' + modal_id).css(\"z-index\", zindex + 1);\r\n    }\r\n\r\n    triggerTooltip();\r\n}\r\n\r\nfunction openChangeUserPasswordModal(ele) {\r\n    let color = \"info\";\r\n    var modal_id = \"change_password_modal\";\r\n\r\n    var gui = \"\";\r\n    gui += \"<div id='\" + modal_id + \"' class='modal \" + color + \" fade' role='dialog'>\";\r\n    gui += \"<div class='modal-dialog'>\";\r\n    gui += \"<div class='modal-content'>\";\r\n    gui += \"<div class='modal-header'><h4 class='modal-title text-capitalize'>Change User Password</h4></div>\";\r\n    gui += \"<div class='modal-body'>\";\r\n\r\n    gui += \"<form class='form-horizontal' id='change_password_form'>\";\r\n    gui += getTextFiled(\"Admin Password\", \"current_user_password\", \"Admin Password\", \"password\");\r\n    gui += getTextFiled(\"User Password\", \"user_password\", \"User Password\", \"password\");\r\n    gui += getTextFiled(\"Repeat User Password\", \"user_password_2\", \"Repeat User Password\", \"password\");\r\n    gui += \"<input type='hidden' id='user_password_id' value='\" + ele.closest(\"tr\").attr(\"data-id\") + \"'>\";\r\n    gui += \"</form>\";\r\n\r\n    gui += \"</div>\";\r\n    gui += \"<div class='modal-footer'>\";\r\n    gui += \"<button type='submit' form='change_password_form' id='change_password' class='btn btn-\" + color + \"'>Change</button>\";\r\n    gui += \"<button type='reset' form='change_password_form' class='btn btn-default'>Clear</button>\";\r\n    gui += \"<button type='button' class='btn btn-default' data-dismiss='modal'>Cancel</button>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n\r\n    if ($('#' + modal_id).length) {\r\n        $('#' + modal_id).replaceWith(gui);\r\n    } else {\r\n        $(\"body\").append(gui);\r\n    }\r\n\r\n    $('#' + modal_id).modal({backdrop: 'static', keyboard: false}, 'show');\r\n\r\n\r\n    if ($(\".modal.in\").length > 0) {\r\n        var zindex = JSON.parse($(\".modal.in:last\").css(\"z-index\"));\r\n        $('#' + modal_id).css(\"z-index\", zindex + 1);\r\n    }\r\n\r\n    triggerTooltip();\r\n}\r\n\r\nfunction openChangePasswordModal() {\r\n    let color = \"warning\";\r\n    var modal_id = \"change_password_modal\";\r\n\r\n    var gui = \"\";\r\n    gui += \"<div id='\" + modal_id + \"' class='modal \" + color + \" fade' role='dialog'>\";\r\n    gui += \"<div class='modal-dialog'>\";\r\n    gui += \"<div class='modal-content'>\";\r\n    gui += \"<div class='modal-header'><h4 class='modal-title text-capitalize'>Change Password</h4></div>\";\r\n    gui += \"<div class='modal-body'>\";\r\n\r\n    gui += \"<form class='form-horizontal' id='change_password_form'>\";\r\n    gui += getTextFiled(\"Current Password\", \"current_user_password\", \"Current Password\", \"password\");\r\n    gui += getTextFiled(\"New Password\", \"user_password\", \"New Password\", \"password\");\r\n    gui += getTextFiled(\"Repeat New Password\", \"user_password_2\", \"Repeat New Password\", \"password\");\r\n    gui += \"</form>\";\r\n\r\n    gui += \"</div>\";\r\n    gui += \"<div class='modal-footer'>\";\r\n    gui += \"<button type='submit' form='change_password_form' id='change_password' class='btn btn-\" + color + \"'>Change</button>\";\r\n    gui += \"<button type='reset' form='change_password_form' class='btn btn-default'>Clear</button>\";\r\n    gui += \"<button type='button' class='btn btn-default' data-dismiss='modal'>Cancel</button>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n\r\n    if ($('#' + modal_id).length) {\r\n        $('#' + modal_id).replaceWith(gui);\r\n    } else {\r\n        $(\"body\").append(gui);\r\n    }\r\n\r\n    $('#' + modal_id).modal({backdrop: 'static', keyboard: false}, 'show');\r\n\r\n\r\n    if ($(\".modal.in\").length > 0) {\r\n        var zindex = JSON.parse($(\".modal.in:last\").css(\"z-index\"));\r\n        $('#' + modal_id).css(\"z-index\", zindex + 1);\r\n    }\r\n\r\n    triggerTooltip();\r\n}\r\n\r\nfunction openConfirmDeleteModal(ele) {\r\n    let color = \"danger\";\r\n    var modal_id = \"file_delete_modal\";\r\n\r\n    var gui = \"\";\r\n    gui += \"<div id='\" + modal_id + \"' class='modal \" + color + \" fade' role='dialog'>\";\r\n    gui += \"<div class='modal-dialog modal-sm'>\";\r\n    gui += \"<div class='modal-content'>\";\r\n    gui += \"<div class='modal-header'><h4 class='modal-title text-capitalize'>Confirm Delete</h4></div>\";\r\n    gui += \"<div class='modal-body'>\";\r\n\r\n    gui += \"<p><strong>\" + ele.closest(\"tr\").attr(\"data-file_name\") + \"</strong></p>\";\r\n    gui += \"Do you really want to delete?\";\r\n\r\n    gui += \"</div>\";\r\n    gui += \"<div class='modal-footer'>\";\r\n    gui += \"<button type='submit' id='confirm_file_delete' data-file_name='\" + ele.closest(\"tr\").attr(\"data-file_name\") + \"' class='btn btn-\" + color + \"'>Yes</button>\";\r\n    gui += \"<button type='button' class='btn btn-default' data-dismiss='modal'>No</button>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n\r\n    if ($('#' + modal_id).length) {\r\n        $('#' + modal_id).replaceWith(gui);\r\n    } else {\r\n        $(\"body\").append(gui);\r\n    }\r\n\r\n    $('#' + modal_id).modal({backdrop: 'static', keyboard: false}, 'show');\r\n\r\n\r\n    if ($(\".modal.in\").length > 0) {\r\n        var zindex = JSON.parse($(\".modal.in:last\").css(\"z-index\"));\r\n        $('#' + modal_id).css(\"z-index\", zindex + 1);\r\n    }\r\n\r\n    triggerTooltip();\r\n}\r\n\r\nfunction openConfirmLogout() {\r\n    let color = \"danger\";\r\n    var modal_id = \"logout_modal\";\r\n\r\n    var gui = \"\";\r\n    gui += \"<div id='\" + modal_id + \"' class='modal \" + color + \" fade' role='dialog'>\";\r\n    gui += \"<div class='modal-dialog modal-sm'>\";\r\n    gui += \"<div class='modal-content'>\";\r\n    gui += \"<div class='modal-header'><h4 class='modal-title text-capitalize'>Confirm Logout</h4></div>\";\r\n    gui += \"<div class='modal-body'>\";\r\n\r\n    gui += \"Do you really want to logout?\";\r\n\r\n    gui += \"</div>\";\r\n    gui += \"<div class='modal-footer'>\";\r\n    gui += \"<button type='submit' id='confirm_logout' class='btn btn-\" + color + \"'>Yes</button>\";\r\n    gui += \"<button type='button' class='btn btn-default' data-dismiss='modal'>No</button>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n\r\n    if ($('#' + modal_id).length) {\r\n        $('#' + modal_id).replaceWith(gui);\r\n    } else {\r\n        $(\"body\").append(gui);\r\n    }\r\n\r\n    $('#' + modal_id).modal({backdrop: 'static', keyboard: false}, 'show');\r\n\r\n\r\n    if ($(\".modal.in\").length > 0) {\r\n        var zindex = JSON.parse($(\".modal.in:last\").css(\"z-index\"));\r\n        $('#' + modal_id).css(\"z-index\", zindex + 1);\r\n    }\r\n\r\n    triggerTooltip();\r\n}\r\n\r\nfunction openUploadModal() {\r\n    let color = \"primary\";\r\n    var modal_id = \"upload_modal\";\r\n\r\n    var gui = \"\";\r\n    gui += \"<div id='\" + modal_id + \"' class='modal \" + color + \" fade' role='dialog'>\";\r\n    gui += \"<div class='modal-dialog'>\";\r\n    gui += \"<div class='modal-content'>\";\r\n    gui += \"<div class='modal-header'><h4 class='modal-title text-capitalize'>Upload File</h4></div>\";\r\n    gui += \"<div class='modal-body'>\";\r\n\r\n    gui += \"<form id='file_upload_form' action='upload.php' method='post' enctype='multipart/form-data' class='form-horizontal'>\";\r\n\r\n    gui += \"<div class='form-group'>\";\r\n    gui += \"<label for='user_file' class='col-sm-2 control-label'>File</label>\";\r\n    gui += \"<div class='col-sm-10'>\";\r\n    gui += \"<input type='file' class='form-control' id='user_file' multiple>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n\r\n    gui += getSelectedFileTable();\r\n\r\n    gui += \"</form>\";\r\n\r\n\r\n    gui += \"</div>\";\r\n    gui += \"<div class='modal-footer'>\";\r\n    gui += \"<button type='submit' form='file_upload_form' class='btn btn-\" + color + \"'>Upload</button>\";\r\n    gui += \"<button type='button' class='btn btn-default' data-dismiss='modal'>Cancel</button>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n    gui += \"</div>\";\r\n\r\n    if ($('#' + modal_id).length) {\r\n        $('#' + modal_id).replaceWith(gui);\r\n    } else {\r\n        $(\"body\").append(gui);\r\n    }\r\n\r\n    $('#' + modal_id).modal({backdrop: 'static', keyboard: false}, 'show');\r\n\r\n\r\n    if ($(\".modal.in\").length > 0) {\r\n        var zindex = JSON.parse($(\".modal.in:last\").css(\"z-index\"));\r\n        $('#' + modal_id).css(\"z-index\", zindex + 1);\r\n    }\r\n\r\n    triggerTooltip();\r\n}\r\n\r\nfunction isLoggedIn() {\r\n    // console.log(\"is logged in called\");\r\n    $.ajax({\r\n        url: \"../classes/user.php\",\r\n        beforeSend: function () {\r\n        },\r\n        data: {\r\n            operation: \"is_logged_in\"\r\n        },\r\n        type: \"POST\",\r\n        success: function (response) {\r\n            var json_ob = JSON.parse(response);\r\n            if (json_ob !== false) {\r\n                console.log(json_ob);\r\n                if (json_ob.logged_in_user === false) {\r\n                    displayLoginForm(empty_object);\r\n                } else {\r\n                    logged_in_object = json_ob.logged_in_user;\r\n                    file_constraints = json_ob.file_constraints;\r\n\r\n                    if (json_ob.hasOwnProperty(\"users\")) {//admin\r\n                        displayUserTable(json_ob.users);\r\n                    } else {\r\n                        displayUserFiles(json_ob);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        error: function (response) {\r\n\r\n        }\r\n    });\r\n}\r\n\r\nfunction logout() {\r\n    $.ajax({\r\n        url: \"../classes/user.php\",\r\n        beforeSend: function () {\r\n        },\r\n        data: {\r\n            operation: \"signout\"\r\n        },\r\n        type: \"POST\",\r\n        success: function (response) {\r\n            var json_ob = JSON.parse(response);\r\n            if (json_ob !== false) {\r\n                destroyModal($(\"#logout_modal\"));\r\n                displayLoginForm(empty_object);\r\n                showAlert(json_ob);\r\n            }\r\n        },\r\n        error: function (response) {\r\n        }\r\n    });\r\n}\r\n\r\nfunction getEditProfile() {\r\n    $.ajax({\r\n        url: \"../classes/user.php\",\r\n        beforeSend: function () {\r\n        },\r\n        data: {\r\n            operation: \"get_edit_profile\"\r\n        },\r\n        type: \"POST\",\r\n        success: function (response) {\r\n            var json_ob = JSON.parse(response);\r\n            if (json_ob !== false) {\r\n                json_ob[0].operation = \"edit\";\r\n                json_ob[0].operation_type = \"edit_profile\";\r\n                openUserModal(\"edit\", \"warning\", json_ob[0]);\r\n            }\r\n        },\r\n        error: function (response) {\r\n        }\r\n    });\r\n}\r\n\r\nfunction changePassword(ele) {\r\n    let data = {\r\n        operation: \"change_password\",\r\n        current_password: $(\"#change_password_form #current_user_password\").val(),\r\n        user_password: $(\"#change_password_form #user_password\").val(),\r\n        user_password_2: $(\"#change_password_form #user_password_2\").val()\r\n    };\r\n\r\n    if (ele.find(\"#user_password_id\").length) {\r\n        data[\"id\"] = ele.find(\"#user_password_id\").val();\r\n    }\r\n\r\n    $.ajax({\r\n        url: \"../classes/user.php\",\r\n        beforeSend: function () {\r\n        },\r\n        data: data,\r\n        type: \"POST\",\r\n        success: function (response) {\r\n            var json_ob = JSON.parse(response);\r\n            if (json_ob !== false) {\r\n                if (json_ob.logged_in_user === false) {\r\n                    showAlert(setError(\"Invalid credentials\"));\r\n                } else {\r\n                    destroyModal($(\"#change_password_modal\"));\r\n                    showAlert(json_ob.message);\r\n                    logged_in_object = json_ob.logged_in_user;\r\n                    displayUserTable(json_ob.users);\r\n                }\r\n            }\r\n        },\r\n        error: function (response) {\r\n        }\r\n    });\r\n}\r\n\r\nfunction uploadFiles(index) {\r\n    var file_data = selected_files[index];//$('#user_file').prop('files')[0];\r\n    var form_data = new FormData();\r\n    form_data.append('user_files', file_data);\r\n    form_data.append('operation', \"file_upload\");\r\n\r\n\r\n    var progress_bar = \"<div class='progress'>\";\r\n    progress_bar += \"<div class='progress-bar progress-bar-primary progress-bar-striped active' role='progressbar' aria-valuenow='0' aria-valuemin='0' aria-valuemax='100' style='width: 0%'>\";\r\n    progress_bar += \"0%\";\r\n    progress_bar += \"<span class='sr-only'>0% Complete (success)</span>\";\r\n    progress_bar += \"</div>\";\r\n    progress_bar += \"</div>\";\r\n\r\n    $.ajax({\r\n        xhr: function () {\r\n            var xhr = new window.XMLHttpRequest();\r\n            xhr.upload.addEventListener('progress', function (ev) {\r\n                if (ev.lengthComputable) {\r\n                    let form_modal = $(\"#upload_modal\");\r\n                    let selector = \"[data-selected_file_index='\" + index + \"'] .progress_cell\";\r\n\r\n                    if (form_modal.find(\".modal-body \" + selector + \" .progress\").length === 0) {\r\n                        form_modal.find(\".modal-body \" + selector).html(progress_bar);\r\n                    }\r\n\r\n                    var percentage = Math.round(ev.loaded / ev.total * 100);\r\n                    changeProgressBarStatus(form_modal.find(\".modal-body \" + selector + \" .progress-bar\"), percentage);\r\n                    if (percentage === 100) {\r\n                        savingProgressBarStatus(form_modal.find(\".modal-body \" + selector + \" .progress-bar\"));\r\n                    }\r\n                }\r\n            });\r\n            return xhr;\r\n        },\r\n\r\n        url: \"../classes/user.php\",\r\n        beforeSend: function () {\r\n        },\r\n        cache: false,\r\n        contentType: false,\r\n        processData: false,\r\n        data: form_data,\r\n        type: \"POST\",\r\n        success: function (response) {\r\n            var json_ob;\r\n            if (index !== (selected_files.length - 1)) {\r\n\r\n                json_ob = JSON.parse(response);\r\n                if (json_ob !== false) {\r\n                    if (JSON.parse(json_ob.status) === 2) {\r\n                        // destroyModal($(\"#upload_modal\"));\r\n                        displayUserFiles(json_ob);\r\n                    } else {\r\n                        let form_modal = $(\"#upload_modal\");\r\n                        let selector = \"[data-selected_file_index='\" + index + \"'] .progress_cell\";\r\n                        form_modal.find(selector).html(\"Exist\");\r\n                    }\r\n                }\r\n\r\n                uploadFiles(++index);\r\n            } else {\r\n                json_ob = JSON.parse(response);\r\n                if (json_ob !== false) {\r\n                    if (JSON.parse(json_ob.status) === 2) {\r\n                        // destroyModal($(\"#upload_modal\"));\r\n                        displayUserFiles(json_ob);\r\n                    } else {\r\n                        let form_modal = $(\"#upload_modal\");\r\n                        let selector = \"[data-selected_file_index='\" + index + \"'] .progress_cell\";\r\n                        form_modal.find(selector).html(\"<i class='fa fa-ban'></i>\");\r\n                    }\r\n                    showAlert(json_ob.message);\r\n                }\r\n            }\r\n        },\r\n        error: function (response) {\r\n        }\r\n    });\r\n}\r\n\r\nfunction deleteFile(file) {\r\n    $.ajax({\r\n        url: \"../classes/user.php\",\r\n        beforeSend: function () {\r\n        },\r\n        data: {\r\n            operation: \"delete_file\",\r\n            file: file\r\n        },\r\n        type: \"POST\",\r\n        success: function (response) {\r\n            var json_ob = JSON.parse(response);\r\n            if (json_ob !== false) {\r\n                destroyModal($(\"#file_delete_modal\"));\r\n                displayUserFiles(json_ob);\r\n                showAlert(json_ob.message);\r\n            }\r\n        },\r\n        error: function (response) {\r\n        }\r\n    });\r\n}\r\n\r\nfunction changeProgressBarStatus(ele, percentage) {\r\n    ele.attr('aria-valuenow', percentage).css('width', percentage + \"%\").text(percentage + \"%\");\r\n}\r\n\r\nfunction savingProgressBarStatus(ele) {\r\n    // ele.text(\"Upload Completed. Saving data\");\r\n}\r\n\r\nfunction updateSelectedFileTable(files) {\r\n    let max_files_count_error = false;\r\n    let max_file_size_error = false;\r\n\r\n    $.each(files, function (i, file) {\r\n\r\n        if (!max_files_count_error) {\r\n            let found = false;\r\n            $.each(selected_files, function (i, selected_file) {\r\n                if (file.name === selected_file.name) {\r\n                    found = true;\r\n                    return;\r\n                }\r\n            });\r\n\r\n            if (!found) {\r\n                if (selected_files.length < file_constraints.max_files_count) {\r\n                    if (file.size < file_constraints.max_file_size) {\r\n                        selected_files.push(file);\r\n                    } else {\r\n                        max_file_size_error = true;\r\n                        return;\r\n                    }\r\n                } else {\r\n                    max_files_count_error = true;\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    $(\"#user_file\").val(\"\");\r\n\r\n    if (max_files_count_error) {\r\n        showAlert(setError(\"Can't add more than \" + file_constraints.max_files_count + \" files\"));\r\n    } else if (max_file_size_error) {\r\n        showAlert(setError(\"Can't add file larger than \" + formatSizeUnits(file_constraints.max_file_size) + \" \"));\r\n    }\r\n\r\n    displaySelectedFiles();\r\n}\r\n\r\nfunction getSelectedFileTable() {\r\n    let total_size = 0;\r\n    let rows = \"\";\r\n    $.each(selected_files, function (i, selected_file) {\r\n        total_size += Number(selected_file.size);\r\n        rows += \"<tr data-selected_file_index='\" + i + \"'>\";\r\n        rows += \"<td class='small_cell text-center'>\" + (i + 1) + \"</td>\";\r\n        rows += \"<td class='small_cell text-center'>\";\r\n        rows += getButton(\"button\", \"danger btn-xs delete_selected_file\", \"Delete\");\r\n        rows += \"</td>\";\r\n        rows += \"<td>\" + selected_file.name + \"</td>\";\r\n        rows += \"<td class='small_cell text-right'>\" + formatSizeUnits(selected_file.size) + \"</td>\";\r\n        rows += \"<td class='small_cell text-center progress_cell'></td>\";\r\n        rows += \"</tr>\";\r\n    });\r\n\r\n    let table = \"\";\r\n\r\n    table += \"<div class='table-responsive' id='selected_files'>\";\r\n    table += \"<table class='table table-bordered'>\";\r\n    table += \"<caption>Max \" + file_constraints.max_files_count + \" files allowed</caption>\";\r\n\r\n    if (rows !== \"\") {\r\n        table += \"<thead>\";\r\n        table += \"<tr>\";\r\n        table += \"<th class='small_cell'>#</th>\";\r\n        table += \"<th class='small_cell'>Operations</th>\";\r\n        table += \"<th>File</th>\";\r\n        table += \"<th class='small_cell'>Size</th>\";\r\n        table += \"<th class='small_cell'>Progress</th>\";\r\n        table += \"</tr>\";\r\n        table += \"</thead>\";\r\n        table += \"<tbody>\";\r\n        table += rows;\r\n        table += \"</tbody>\";\r\n        table += \"<tfoot>\";\r\n        table += \"<tr>\";\r\n        table += \"<th class='small_cell text-right' colspan='3'>Total</th>\";\r\n        table += \"<th class='small_cell text-right'>\" + formatSizeUnits(total_size) + \"</th>\";\r\n        table += \"</tr>\";\r\n        table += \"</tfoot>\";\r\n    }\r\n\r\n    table += \"</table>\";\r\n    table += \"</div>\";\r\n\r\n    return table;\r\n}\r\n\r\nfunction displaySelectedFiles() {\r\n    let table = getSelectedFileTable();\r\n\r\n    if ($(\"#upload_modal #selected_files\").length) {\r\n        $(\"#upload_modal #selected_files\").replaceWith(table);\r\n    } else {\r\n        $(\"#upload_modal .modal-body\").append(table);\r\n    }\r\n    dragAndDropFunctions();\r\n}\r\n\r\nfunction formatSizeUnits(bytes) {\r\n    if (bytes >= (1024 * 1024 * 1024)) {\r\n        bytes = (bytes / (1024 * 1024 * 1024)).toFixed(2) + ' GB';\r\n    } else if (bytes >= (1024 * 1024)) {\r\n        bytes = (bytes / (1024 * 1024)).toFixed(2) + ' MB';\r\n    } else if (bytes >= 1024) {\r\n        bytes = (bytes / 1024).toFixed(2) + ' KB';\r\n    } else if (bytes > 1) {\r\n        bytes = bytes + ' bytes';\r\n    } else if (bytes === 1) {\r\n        bytes = bytes + ' byte';\r\n    } else {\r\n        bytes = '0 bytes';\r\n    }\r\n\r\n    return bytes;\r\n}\r\n\r\nfunction removeSelectedFile(index) {\r\n    index = Number(index);\r\n    if (index > -1) {\r\n        selected_files.splice(index, 1);\r\n    }\r\n\r\n    displaySelectedFiles();\r\n}\r\n\r\nlet dropArea = null;\r\n\r\nfunction dragAndDropFunctions() {\r\n    // ************************ Drag and drop ***************** //\r\n    dropArea = document.getElementById(\"selected_files\")\r\n\r\n// Prevent default drag behaviors\r\n    ;['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {\r\n        dropArea.addEventListener(eventName, preventDefaults, false)\r\n        document.body.addEventListener(eventName, preventDefaults, false)\r\n    })\r\n\r\n// Highlight drop area when item is dragged over it\r\n    ;['dragenter', 'dragover'].forEach(eventName => {\r\n        dropArea.addEventListener(eventName, highlight, false)\r\n    })\r\n\r\n    ;['dragleave', 'drop'].forEach(eventName => {\r\n        dropArea.addEventListener(eventName, unhighlight, false)\r\n    })\r\n\r\n// Handle dropped files\r\n    dropArea.addEventListener('drop', handleDrop, false)\r\n}\r\n\r\n///drag and drop\r\n\r\nfunction preventDefaults(e) {\r\n    e.preventDefault()\r\n    e.stopPropagation()\r\n}\r\n\r\nfunction highlight(e) {\r\n    dropArea.classList.add('highlight')\r\n}\r\n\r\nfunction unhighlight(e) {\r\n    dropArea.classList.remove('active')\r\n}\r\n\r\nfunction handleDrop(e) {\r\n    var dt = e.dataTransfer;\r\n    var files = dt.files;\r\n    console.log(files);\r\n    updateSelectedFileTable(files);\r\n}"]}